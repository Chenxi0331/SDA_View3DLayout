{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\chenx\\\\Documents\\\\sda\\\\prototype\\\\client\\\\src\\\\ThreeDViewer.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef } from 'react';\nimport * as THREE from 'three';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ThreeDViewer = ({\n  layoutData\n}) => {\n  _s();\n  const mountRef = useRef(null);\n  const sceneRef = useRef(null);\n  const rendererRef = useRef(null);\n  const controlsRef = useRef(null);\n  useEffect(() => {\n    // --- Init Scene ---\n    const width = mountRef.current.clientWidth;\n    const height = mountRef.current.clientHeight;\n    const scene = new THREE.Scene();\n    scene.background = new THREE.Color(0xf0f0f0); // Soft grey background\n    // scene.fog = new THREE.Fog(0xf0f0f0, 20, 100); \n    sceneRef.current = scene;\n    const camera = new THREE.PerspectiveCamera(45, width / height, 0.1, 1000);\n    camera.position.set(0, 20, 30);\n    camera.lookAt(0, 0, 0);\n    const renderer = new THREE.WebGLRenderer({\n      antialias: true\n    });\n    renderer.setSize(width, height);\n    renderer.shadowMap.enabled = true; // Enable Shadows\n    renderer.shadowMap.type = THREE.PCFSoftShadowMap;\n    renderer.outputColorSpace = THREE.SRGBColorSpace; // Correct colors\n    mountRef.current.appendChild(renderer.domElement);\n    rendererRef.current = renderer;\n\n    // --- Controls ---\n    const controls = new OrbitControls(camera, renderer.domElement);\n    controls.enableDamping = true;\n    controls.dampingFactor = 0.05;\n    // Limit controls to avoid going below ground\n    controls.maxPolarAngle = Math.PI / 2 - 0.1;\n    controlsRef.current = controls;\n\n    // --- Environment ---\n    // Floor with Wood Texture\n    const textureLoader = new THREE.TextureLoader();\n    // Assuming file exists in public/wooden_table_02_4k.blend/textures/... \n    // Note: The path structure in public seems to be a raw copy of files.\n    const woodTexture = textureLoader.load('/wooden_table_02_4k.blend/textures/wooden_table_02_diff_4k.jpg', texture => {\n      texture.wrapS = THREE.RepeatWrapping;\n      texture.wrapT = THREE.RepeatWrapping;\n      texture.repeat.set(10, 10);\n      texture.colorSpace = THREE.SRGBColorSpace;\n      console.log(\"Floor texture loaded\");\n    }, undefined, err => console.error(\"Error loading floor texture\", err));\n    const floorGeometry = new THREE.PlaneGeometry(100, 100);\n    const floorMaterial = new THREE.MeshStandardMaterial({\n      map: woodTexture,\n      roughness: 0.8,\n      metalness: 0.1,\n      color: 0xffffff // Modify tint if needed\n    });\n    const floor = new THREE.Mesh(floorGeometry, floorMaterial);\n    floor.rotation.x = -Math.PI / 2;\n    floor.receiveShadow = true;\n    scene.add(floor);\n    const gridHelper = new THREE.GridHelper(100, 50, 0xcccccc, 0xeeeeee);\n    scene.add(gridHelper);\n\n    // --- Lighting ---\n    const ambientLight = new THREE.AmbientLight(0xffffff, 0.7); // Increased Ambient\n    scene.add(ambientLight);\n    const hemiLight = new THREE.HemisphereLight(0xffffff, 0x444444, 0.6);\n    hemiLight.position.set(0, 20, 0);\n    scene.add(hemiLight);\n    const dirLight = new THREE.DirectionalLight(0xffffff, 1.5);\n    dirLight.position.set(10, 30, 20); // Higher and angled\n    dirLight.castShadow = true;\n    // Optimization: Reduced shadow map size for performance\n    dirLight.shadow.mapSize.width = 1024;\n    dirLight.shadow.mapSize.height = 1024;\n    dirLight.shadow.bias = -0.0001; // Reduce shadow artifacts\n    dirLight.shadow.camera.near = 0.5;\n    dirLight.shadow.camera.far = 100;\n    dirLight.shadow.camera.left = -50;\n    dirLight.shadow.camera.right = 50;\n    dirLight.shadow.camera.top = 50;\n    dirLight.shadow.camera.bottom = -50;\n    scene.add(dirLight);\n\n    // --- Animation Loop ---\n    const animate = () => {\n      requestAnimationFrame(animate);\n      controls.update();\n      renderer.render(scene, camera);\n    };\n    animate();\n    return () => {\n      if (mountRef.current && renderer.domElement) {\n        mountRef.current.removeChild(renderer.domElement);\n      }\n      renderer.dispose();\n      controls.dispose();\n    };\n  }, []);\n\n  // --- Update Layout ---\n  useEffect(() => {\n    if (!layoutData || !sceneRef.current) return;\n\n    // Clear previous generic meshes (keep lights/helpers/floor)\n    const scene = sceneRef.current;\n\n    // Remove old layout groups (detect by userData.entityId)\n    for (let i = scene.children.length - 1; i >= 0; i--) {\n      const child = scene.children[i];\n      // We only remove the objects that are part of our data structure\n      if (child.userData.entityId) {\n        // IMPORTANT: Dispose resources before removing from scene\n        // If the object has a dispose method (from our Pattern), usage it.\n        // Note: We need a way to link the Scene Object back to our JS Class if we want to call .dispose() on the class.\n        // However, our class `dispose` cleans up Three.js resources provided we have access to it.\n        // Since `child` here is a THREE.Group, we can traverse and clean standard things.\n\n        // Better approach: If we attached the class instance to userData, we could call it.\n        // But `PrototypePattern.js` attaches primitive data to userData.\n\n        // Fallback: Manual cleanup or if we had a reference to the previous layout object.\n        // Ideally, `ThreeDViewer` should track the `currentLayout` object to call dispose on it.\n\n        scene.remove(child);\n      }\n    }\n\n    // Add New Layout\n    const rootGroup = layoutData.group;\n    scene.add(rootGroup);\n    console.log(\"Adding layout to scene:\", layoutData);\n\n    // Update Camera View if defined\n    if (layoutData.cameraView && controlsRef.current && sceneRef.current) {\n      const {\n        position,\n        target\n      } = layoutData.cameraView;\n      // Get camera from controls\n      const camera = controlsRef.current.object;\n      if (position) camera.position.set(position.x, position.y, position.z);\n      if (target) controlsRef.current.target.set(target.x, target.y, target.z);\n      controlsRef.current.update();\n      console.log(\"Updated camera view based on layout settings.\");\n    }\n\n    // Cleanup function: Called when layoutData changes or component unmounts\n    return () => {\n      // Use the Pattern's dispose logic which protects shared assets\n      if (layoutData && typeof layoutData.dispose === 'function') {\n        console.log(\"Disposing resources for layout:\", layoutData.id);\n        layoutData.dispose();\n      }\n    };\n  }, [layoutData]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: mountRef,\n    style: {\n      width: '100%',\n      height: '600px',\n      border: '1px solid #ccc',\n      borderRadius: '8px',\n      overflow: 'hidden'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 172,\n    columnNumber: 12\n  }, this);\n};\n_s(ThreeDViewer, \"gNQSLE6j3y2KY/R6Eea4wBpewjI=\");\n_c = ThreeDViewer;\nexport default ThreeDViewer;\nvar _c;\n$RefreshReg$(_c, \"ThreeDViewer\");","map":{"version":3,"names":["React","useEffect","useRef","THREE","OrbitControls","jsxDEV","_jsxDEV","ThreeDViewer","layoutData","_s","mountRef","sceneRef","rendererRef","controlsRef","width","current","clientWidth","height","clientHeight","scene","Scene","background","Color","camera","PerspectiveCamera","position","set","lookAt","renderer","WebGLRenderer","antialias","setSize","shadowMap","enabled","type","PCFSoftShadowMap","outputColorSpace","SRGBColorSpace","appendChild","domElement","controls","enableDamping","dampingFactor","maxPolarAngle","Math","PI","textureLoader","TextureLoader","woodTexture","load","texture","wrapS","RepeatWrapping","wrapT","repeat","colorSpace","console","log","undefined","err","error","floorGeometry","PlaneGeometry","floorMaterial","MeshStandardMaterial","map","roughness","metalness","color","floor","Mesh","rotation","x","receiveShadow","add","gridHelper","GridHelper","ambientLight","AmbientLight","hemiLight","HemisphereLight","dirLight","DirectionalLight","castShadow","shadow","mapSize","bias","near","far","left","right","top","bottom","animate","requestAnimationFrame","update","render","removeChild","dispose","i","children","length","child","userData","entityId","remove","rootGroup","group","cameraView","target","object","y","z","id","ref","style","border","borderRadius","overflow","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/chenx/Documents/sda/prototype/client/src/ThreeDViewer.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\r\nimport * as THREE from 'three';\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';\r\n\r\nconst ThreeDViewer = ({ layoutData }) => {\r\n    const mountRef = useRef(null);\r\n    const sceneRef = useRef(null);\r\n    const rendererRef = useRef(null);\r\n    const controlsRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        // --- Init Scene ---\r\n        const width = mountRef.current.clientWidth;\r\n        const height = mountRef.current.clientHeight;\r\n\r\n        const scene = new THREE.Scene();\r\n        scene.background = new THREE.Color(0xf0f0f0); // Soft grey background\r\n        // scene.fog = new THREE.Fog(0xf0f0f0, 20, 100); \r\n        sceneRef.current = scene;\r\n\r\n        const camera = new THREE.PerspectiveCamera(45, width / height, 0.1, 1000);\r\n        camera.position.set(0, 20, 30);\r\n        camera.lookAt(0, 0, 0);\r\n\r\n        const renderer = new THREE.WebGLRenderer({ antialias: true });\r\n        renderer.setSize(width, height);\r\n        renderer.shadowMap.enabled = true; // Enable Shadows\r\n        renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n        renderer.outputColorSpace = THREE.SRGBColorSpace; // Correct colors\r\n        mountRef.current.appendChild(renderer.domElement);\r\n        rendererRef.current = renderer;\r\n\r\n        // --- Controls ---\r\n        const controls = new OrbitControls(camera, renderer.domElement);\r\n        controls.enableDamping = true;\r\n        controls.dampingFactor = 0.05;\r\n        // Limit controls to avoid going below ground\r\n        controls.maxPolarAngle = Math.PI / 2 - 0.1;\r\n        controlsRef.current = controls;\r\n\r\n        // --- Environment ---\r\n        // Floor with Wood Texture\r\n        const textureLoader = new THREE.TextureLoader();\r\n        // Assuming file exists in public/wooden_table_02_4k.blend/textures/... \r\n        // Note: The path structure in public seems to be a raw copy of files.\r\n        const woodTexture = textureLoader.load('/wooden_table_02_4k.blend/textures/wooden_table_02_diff_4k.jpg',\r\n            (texture) => {\r\n                texture.wrapS = THREE.RepeatWrapping;\r\n                texture.wrapT = THREE.RepeatWrapping;\r\n                texture.repeat.set(10, 10);\r\n                texture.colorSpace = THREE.SRGBColorSpace;\r\n                console.log(\"Floor texture loaded\");\r\n            },\r\n            undefined,\r\n            (err) => console.error(\"Error loading floor texture\", err)\r\n        );\r\n\r\n        const floorGeometry = new THREE.PlaneGeometry(100, 100);\r\n        const floorMaterial = new THREE.MeshStandardMaterial({\r\n            map: woodTexture,\r\n            roughness: 0.8,\r\n            metalness: 0.1,\r\n            color: 0xffffff // Modify tint if needed\r\n        });\r\n\r\n        const floor = new THREE.Mesh(floorGeometry, floorMaterial);\r\n        floor.rotation.x = -Math.PI / 2;\r\n        floor.receiveShadow = true;\r\n        scene.add(floor);\r\n\r\n        const gridHelper = new THREE.GridHelper(100, 50, 0xcccccc, 0xeeeeee);\r\n        scene.add(gridHelper);\r\n\r\n        // --- Lighting ---\r\n        const ambientLight = new THREE.AmbientLight(0xffffff, 0.7); // Increased Ambient\r\n        scene.add(ambientLight);\r\n\r\n        const hemiLight = new THREE.HemisphereLight(0xffffff, 0x444444, 0.6);\r\n        hemiLight.position.set(0, 20, 0);\r\n        scene.add(hemiLight);\r\n\r\n        const dirLight = new THREE.DirectionalLight(0xffffff, 1.5);\r\n        dirLight.position.set(10, 30, 20); // Higher and angled\r\n        dirLight.castShadow = true;\r\n        // Optimization: Reduced shadow map size for performance\r\n        dirLight.shadow.mapSize.width = 1024;\r\n        dirLight.shadow.mapSize.height = 1024;\r\n        dirLight.shadow.bias = -0.0001; // Reduce shadow artifacts\r\n        dirLight.shadow.camera.near = 0.5;\r\n        dirLight.shadow.camera.far = 100;\r\n        dirLight.shadow.camera.left = -50;\r\n        dirLight.shadow.camera.right = 50;\r\n        dirLight.shadow.camera.top = 50;\r\n        dirLight.shadow.camera.bottom = -50;\r\n        scene.add(dirLight);\r\n\r\n        // --- Animation Loop ---\r\n        const animate = () => {\r\n            requestAnimationFrame(animate);\r\n            controls.update();\r\n            renderer.render(scene, camera);\r\n        };\r\n        animate();\r\n\r\n        return () => {\r\n            if (mountRef.current && renderer.domElement) {\r\n                mountRef.current.removeChild(renderer.domElement);\r\n            }\r\n            renderer.dispose();\r\n            controls.dispose();\r\n        };\r\n    }, []);\r\n\r\n    // --- Update Layout ---\r\n    useEffect(() => {\r\n        if (!layoutData || !sceneRef.current) return;\r\n\r\n        // Clear previous generic meshes (keep lights/helpers/floor)\r\n        const scene = sceneRef.current;\r\n\r\n        // Remove old layout groups (detect by userData.entityId)\r\n        for (let i = scene.children.length - 1; i >= 0; i--) {\r\n            const child = scene.children[i];\r\n            // We only remove the objects that are part of our data structure\r\n            if (child.userData.entityId) {\r\n                // IMPORTANT: Dispose resources before removing from scene\r\n                // If the object has a dispose method (from our Pattern), usage it.\r\n                // Note: We need a way to link the Scene Object back to our JS Class if we want to call .dispose() on the class.\r\n                // However, our class `dispose` cleans up Three.js resources provided we have access to it.\r\n                // Since `child` here is a THREE.Group, we can traverse and clean standard things.\r\n\r\n                // Better approach: If we attached the class instance to userData, we could call it.\r\n                // But `PrototypePattern.js` attaches primitive data to userData.\r\n\r\n                // Fallback: Manual cleanup or if we had a reference to the previous layout object.\r\n                // Ideally, `ThreeDViewer` should track the `currentLayout` object to call dispose on it.\r\n\r\n                scene.remove(child);\r\n            }\r\n        }\r\n\r\n        // Add New Layout\r\n        const rootGroup = layoutData.group;\r\n        scene.add(rootGroup);\r\n\r\n        console.log(\"Adding layout to scene:\", layoutData);\r\n\r\n        // Update Camera View if defined\r\n        if (layoutData.cameraView && controlsRef.current && sceneRef.current) {\r\n            const { position, target } = layoutData.cameraView;\r\n            // Get camera from controls\r\n            const camera = controlsRef.current.object;\r\n\r\n            if (position) camera.position.set(position.x, position.y, position.z);\r\n            if (target) controlsRef.current.target.set(target.x, target.y, target.z);\r\n\r\n            controlsRef.current.update();\r\n            console.log(\"Updated camera view based on layout settings.\");\r\n        }\r\n\r\n        // Cleanup function: Called when layoutData changes or component unmounts\r\n        return () => {\r\n            // Use the Pattern's dispose logic which protects shared assets\r\n            if (layoutData && typeof layoutData.dispose === 'function') {\r\n                console.log(\"Disposing resources for layout:\", layoutData.id);\r\n                layoutData.dispose();\r\n            }\r\n        };\r\n\r\n    }, [layoutData]);\r\n\r\n    return <div ref={mountRef} style={{ width: '100%', height: '600px', border: '1px solid #ccc', borderRadius: '8px', overflow: 'hidden' }} />;\r\n};\r\n\r\nexport default ThreeDViewer;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}