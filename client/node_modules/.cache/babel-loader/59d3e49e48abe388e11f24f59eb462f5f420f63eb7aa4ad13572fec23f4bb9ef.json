{"ast":null,"code":"/**\r\n * 3D Real Estate Management System - Prototype Pattern Implementation\r\n * Definition of Prototype Interface and Entities\r\n */\n\nimport * as THREE from 'three';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\nimport * as SkeletonUtils from 'three/examples/jsm/utils/SkeletonUtils';\n\n/**\r\n * Interface Component acting as the Prototype\r\n * All entities must implement a clone() method.\r\n */\n\nclass Wall {\n  constructor(width, height, depth) {\n    this.width = width;\n    this.height = height;\n    this.depth = depth;\n\n    // Create textured/colored wall\n    const geometry = new THREE.BoxGeometry(width, height, depth);\n    const material = new THREE.MeshStandardMaterial({\n      color: 0xf5f5f5,\n      // Off-white\n      roughness: 0.8,\n      side: THREE.DoubleSide\n    });\n    this.mesh = new THREE.Mesh(geometry, material);\n    this.mesh.castShadow = true;\n    this.mesh.receiveShadow = true;\n    this.mesh.userData = {\n      entityId: this.generateId(),\n      type: 'Wall'\n    };\n  }\n  generateId() {\n    return Math.random().toString(36).substr(2, 9);\n  }\n  setPosition(x, y, z) {\n    this.mesh.position.set(x, y, z);\n  }\n  clone() {\n    const clonedWall = new Wall(this.width, this.height, this.depth);\n    clonedWall.mesh.position.copy(this.mesh.position);\n    clonedWall.mesh.rotation.copy(this.mesh.rotation);\n    clonedWall.mesh.userData.entityId = this.generateId();\n    return clonedWall;\n  }\n}\nclass Furniture {\n  constructor(name, type, modelUrl = null) {\n    this.name = name;\n    this.type = type;\n    this.modelUrl = modelUrl;\n\n    // Default Mesh (Box) until model is loaded\n    this.mesh = new THREE.Mesh(new THREE.BoxGeometry(2, 2, 2), new THREE.MeshStandardMaterial({\n      color: 0x888888\n    }));\n    this.mesh.castShadow = true;\n    this.mesh.receiveShadow = true;\n    this.mesh.userData = {\n      entityId: this.generateId(),\n      type: 'Furniture',\n      name: name\n    };\n    this.root = new THREE.Group();\n    this.root.add(this.mesh); // Add placeholder initially\n    this.root.userData = {\n      entityId: this.generateId(),\n      type: 'Furniture',\n      name: name\n    };\n  }\n  generateId() {\n    return Math.random().toString(36).substr(2, 9);\n  }\n  setPosition(x, y, z) {\n    this.root.position.set(x, y, z);\n  }\n  setScale(x, y, z) {\n    this.root.scale.set(x, y, z);\n  }\n  setRotation(x, y, z) {\n    this.root.rotation.set(x, y, z);\n  }\n\n  /**\r\n   * Async Load Model\r\n   */\n  async loadModel(loader) {\n    if (!this.modelUrl) return;\n    try {\n      const gltf = await loader.loadAsync(this.modelUrl);\n      const model = gltf.scene;\n\n      // Enable shadows\n      model.traverse(node => {\n        if (node.isMesh) {\n          node.castShadow = true;\n          node.receiveShadow = true;\n        }\n      });\n\n      // Replace placeholder with real model\n      this.root.remove(this.mesh); // Remove box\n      this.root.add(model);\n      this.mesh = model; // Update reference for cloning logic if needed\n\n      console.log(`Loaded model for ${this.name}`);\n    } catch (err) {\n      console.error(`Failed to load model for ${this.name}`, err);\n      // Keep placeholder\n    }\n  }\n\n  /**\r\n   * Factory method to create instance from JSON data\r\n   */\n  static fromJSON(data) {\n    const furniture = new Furniture(data.name, data.type, data.modelUrl);\n    if (data.position) furniture.setPosition(data.position.x, data.position.y, data.position.z);\n    if (data.rotation) furniture.setRotation(data.rotation.x, data.rotation.y, data.rotation.z);\n    if (data.scale) furniture.setScale(data.scale.x, data.scale.y, data.scale.z);\n    return furniture;\n  }\n\n  /**\r\n   * Deep Clone\r\n   */\n  clone() {\n    // Create new instance with same metadata\n    const clonedFurniture = new Furniture(this.name, this.type, this.modelUrl);\n\n    // Deep Clone the visual root using SkeletonUtils for GLTF support\n    const clonedRoot = SkeletonUtils.clone(this.root);\n    clonedFurniture.root = clonedRoot;\n\n    // IMPORTANT: Update unique ID\n    clonedFurniture.root.userData.entityId = this.generateId();\n    clonedFurniture.root.userData.type = 'Furniture';\n    clonedFurniture.root.userData.name = this.name;\n    return clonedFurniture;\n  }\n}\nclass Room {\n  constructor(name, width = 20, depth = 20) {\n    this.name = name;\n    this.width = width;\n    this.depth = depth;\n    this.furnitureList = [];\n    this.walls = [];\n    this.group = new THREE.Group();\n    this.group.userData = {\n      entityId: this.generateId(),\n      type: 'Room',\n      name: name\n    };\n\n    // Generate Walls automatically\n    this.generateWalls();\n  }\n  generateId() {\n    return Math.random().toString(36).substr(2, 9);\n  }\n  generateWalls() {\n    const h = 10; // Wall Height\n    const t = 0.5; // Wall Thickness\n\n    // Remove old walls if any\n    this.walls.forEach(w => this.group.remove(w.mesh));\n    this.walls = [];\n\n    // 1. Back Wall\n    const back = new Wall(this.width, h, t);\n    back.setPosition(0, h / 2, -this.depth / 2);\n    this.addWall(back);\n\n    // 2. Front Wall\n    const front = new Wall(this.width, h, t);\n    front.setPosition(0, h / 2, this.depth / 2);\n    this.addWall(front);\n\n    // 3. Left Wall\n    const left = new Wall(t, h, this.depth);\n    left.setPosition(-this.width / 2, h / 2, 0);\n    this.addWall(left);\n\n    // 4. Right Wall\n    const right = new Wall(t, h, this.depth);\n    right.setPosition(this.width / 2, h / 2, 0);\n    this.addWall(right);\n  }\n  addWall(wall) {\n    this.walls.push(wall);\n    this.group.add(wall.mesh);\n  }\n  addFurniture(furniture) {\n    this.furnitureList.push(furniture);\n    this.group.add(furniture.root);\n  }\n\n  /**\r\n   * Factory method to create instance from JSON data\r\n   */\n  static fromJSON(data) {\n    const room = new Room(data.name, data.width, data.depth);\n    if (data.furniture) {\n      data.furniture.forEach(itemData => {\n        const furniture = Furniture.fromJSON(itemData);\n        room.addFurniture(furniture);\n      });\n    }\n    return room;\n  }\n\n  /**\r\n   * Deep Clone\r\n   */\n  clone() {\n    const clonedRoom = new Room(this.name, this.width, this.depth);\n\n    // Clone Furniture\n    this.furnitureList.forEach(item => {\n      const clonedItem = item.clone();\n      clonedRoom.addFurniture(clonedItem);\n    });\n\n    // Copy room transform\n    clonedRoom.group.position.copy(this.group.position);\n    clonedRoom.group.userData.entityId = this.generateId();\n\n    // Note: Walls are generated by constructor, so they are fresh and correct size. \n    // No need to manually clone them unless we support custom wall modifications.\n\n    return clonedRoom;\n  }\n}\nclass Layout3D {\n  constructor(id, description) {\n    this.id = id;\n    this.description = description;\n    this.rooms = [];\n    this.group = new THREE.Group();\n    this.group.userData = {\n      entityId: id,\n      type: 'Layout3D',\n      isMaster: true\n    };\n  }\n  addRoom(room) {\n    this.rooms.push(room);\n    this.group.add(room.group);\n  }\n\n  /**\r\n   * Async Load all assets\r\n   */\n  async loadAssets() {\n    const loader = new GLTFLoader();\n    const promises = [];\n    this.rooms.forEach(room => {\n      room.furnitureList.forEach(furniture => {\n        promises.push(furniture.loadModel(loader));\n      });\n    });\n    await Promise.all(promises);\n  }\n  static fromJSON(data) {\n    const layout = new Layout3D(data.id, data.name);\n    if (data.rooms) {\n      data.rooms.forEach(roomData => {\n        const room = Room.fromJSON(roomData);\n        layout.addRoom(room);\n      });\n    }\n    return layout;\n  }\n  clone() {\n    const clonedLayout = new Layout3D(this.id, this.description);\n\n    // Deep clone rooms\n    this.rooms.forEach(room => {\n      const clonedRoom = room.clone();\n      clonedLayout.addRoom(clonedRoom);\n    });\n    clonedLayout.group.userData.isMaster = false;\n    return clonedLayout;\n  }\n}\n\n/**\r\n * Prototype Registry\r\n */\nclass LayoutRegistry {\n  constructor() {\n    this.masters = new Map();\n  }\n  registerMaster(id, layout) {\n    console.log(`[Registry] Registering Master Layout: ${id}`);\n    this.masters.set(id, layout);\n  }\n  getSessionClone(id) {\n    const master = this.masters.get(id);\n    if (!master) {\n      throw new Error(`Layout ${id} not found in registry.`);\n    }\n    // console.log(`[Registry] Creating Session Clone for: ${id}`);\n    return master.clone();\n  }\n}\nexport { Furniture, Wall, Room, Layout3D, LayoutRegistry };","map":{"version":3,"names":["THREE","GLTFLoader","SkeletonUtils","Wall","constructor","width","height","depth","geometry","BoxGeometry","material","MeshStandardMaterial","color","roughness","side","DoubleSide","mesh","Mesh","castShadow","receiveShadow","userData","entityId","generateId","type","Math","random","toString","substr","setPosition","x","y","z","position","set","clone","clonedWall","copy","rotation","Furniture","name","modelUrl","root","Group","add","setScale","scale","setRotation","loadModel","loader","gltf","loadAsync","model","scene","traverse","node","isMesh","remove","console","log","err","error","fromJSON","data","furniture","clonedFurniture","clonedRoot","Room","furnitureList","walls","group","generateWalls","h","t","forEach","w","back","addWall","front","left","right","wall","push","addFurniture","room","itemData","clonedRoom","item","clonedItem","Layout3D","id","description","rooms","isMaster","addRoom","loadAssets","promises","Promise","all","layout","roomData","clonedLayout","LayoutRegistry","masters","Map","registerMaster","getSessionClone","master","get","Error"],"sources":["C:/Users/chenx/Documents/sda/prototype/client/src/PrototypePattern.js"],"sourcesContent":["/**\r\n * 3D Real Estate Management System - Prototype Pattern Implementation\r\n * Definition of Prototype Interface and Entities\r\n */\r\n\r\nimport * as THREE from 'three';\r\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\r\nimport * as SkeletonUtils from 'three/examples/jsm/utils/SkeletonUtils';\r\n\r\n/**\r\n * Interface Component acting as the Prototype\r\n * All entities must implement a clone() method.\r\n */\r\n\r\nclass Wall {\r\n    constructor(width, height, depth) {\r\n        this.width = width;\r\n        this.height = height;\r\n        this.depth = depth;\r\n\r\n        // Create textured/colored wall\r\n        const geometry = new THREE.BoxGeometry(width, height, depth);\r\n        const material = new THREE.MeshStandardMaterial({\r\n            color: 0xf5f5f5, // Off-white\r\n            roughness: 0.8,\r\n            side: THREE.DoubleSide\r\n        });\r\n\r\n        this.mesh = new THREE.Mesh(geometry, material);\r\n        this.mesh.castShadow = true;\r\n        this.mesh.receiveShadow = true;\r\n        this.mesh.userData = { entityId: this.generateId(), type: 'Wall' };\r\n    }\r\n\r\n    generateId() {\r\n        return Math.random().toString(36).substr(2, 9);\r\n    }\r\n\r\n    setPosition(x, y, z) {\r\n        this.mesh.position.set(x, y, z);\r\n    }\r\n\r\n    clone() {\r\n        const clonedWall = new Wall(this.width, this.height, this.depth);\r\n        clonedWall.mesh.position.copy(this.mesh.position);\r\n        clonedWall.mesh.rotation.copy(this.mesh.rotation);\r\n        clonedWall.mesh.userData.entityId = this.generateId();\r\n        return clonedWall;\r\n    }\r\n}\r\n\r\nclass Furniture {\r\n    constructor(name, type, modelUrl = null) {\r\n        this.name = name;\r\n        this.type = type;\r\n        this.modelUrl = modelUrl;\r\n\r\n        // Default Mesh (Box) until model is loaded\r\n        this.mesh = new THREE.Mesh(\r\n            new THREE.BoxGeometry(2, 2, 2),\r\n            new THREE.MeshStandardMaterial({ color: 0x888888 })\r\n        );\r\n        this.mesh.castShadow = true;\r\n        this.mesh.receiveShadow = true;\r\n        this.mesh.userData = { entityId: this.generateId(), type: 'Furniture', name: name };\r\n\r\n        this.root = new THREE.Group();\r\n        this.root.add(this.mesh); // Add placeholder initially\r\n        this.root.userData = { entityId: this.generateId(), type: 'Furniture', name: name };\r\n    }\r\n\r\n    generateId() {\r\n        return Math.random().toString(36).substr(2, 9);\r\n    }\r\n\r\n    setPosition(x, y, z) {\r\n        this.root.position.set(x, y, z);\r\n    }\r\n\r\n    setScale(x, y, z) {\r\n        this.root.scale.set(x, y, z);\r\n    }\r\n\r\n    setRotation(x, y, z) {\r\n        this.root.rotation.set(x, y, z);\r\n    }\r\n\r\n    /**\r\n     * Async Load Model\r\n     */\r\n    async loadModel(loader) {\r\n        if (!this.modelUrl) return;\r\n\r\n        try {\r\n            const gltf = await loader.loadAsync(this.modelUrl);\r\n            const model = gltf.scene;\r\n\r\n            // Enable shadows\r\n            model.traverse((node) => {\r\n                if (node.isMesh) {\r\n                    node.castShadow = true;\r\n                    node.receiveShadow = true;\r\n                }\r\n            });\r\n\r\n            // Replace placeholder with real model\r\n            this.root.remove(this.mesh); // Remove box\r\n            this.root.add(model);\r\n            this.mesh = model; // Update reference for cloning logic if needed\r\n\r\n            console.log(`Loaded model for ${this.name}`);\r\n        } catch (err) {\r\n            console.error(`Failed to load model for ${this.name}`, err);\r\n            // Keep placeholder\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Factory method to create instance from JSON data\r\n     */\r\n    static fromJSON(data) {\r\n        const furniture = new Furniture(data.name, data.type, data.modelUrl);\r\n        if (data.position) furniture.setPosition(data.position.x, data.position.y, data.position.z);\r\n        if (data.rotation) furniture.setRotation(data.rotation.x, data.rotation.y, data.rotation.z);\r\n        if (data.scale) furniture.setScale(data.scale.x, data.scale.y, data.scale.z);\r\n        return furniture;\r\n    }\r\n\r\n    /**\r\n     * Deep Clone\r\n     */\r\n    clone() {\r\n        // Create new instance with same metadata\r\n        const clonedFurniture = new Furniture(this.name, this.type, this.modelUrl);\r\n\r\n        // Deep Clone the visual root using SkeletonUtils for GLTF support\r\n        const clonedRoot = SkeletonUtils.clone(this.root);\r\n\r\n        clonedFurniture.root = clonedRoot;\r\n\r\n        // IMPORTANT: Update unique ID\r\n        clonedFurniture.root.userData.entityId = this.generateId();\r\n        clonedFurniture.root.userData.type = 'Furniture';\r\n        clonedFurniture.root.userData.name = this.name;\r\n\r\n        return clonedFurniture;\r\n    }\r\n}\r\n\r\nclass Room {\r\n    constructor(name, width = 20, depth = 20) {\r\n        this.name = name;\r\n        this.width = width;\r\n        this.depth = depth;\r\n        this.furnitureList = [];\r\n        this.walls = [];\r\n        this.group = new THREE.Group();\r\n        this.group.userData = { entityId: this.generateId(), type: 'Room', name: name };\r\n\r\n        // Generate Walls automatically\r\n        this.generateWalls();\r\n    }\r\n\r\n    generateId() {\r\n        return Math.random().toString(36).substr(2, 9);\r\n    }\r\n\r\n    generateWalls() {\r\n        const h = 10; // Wall Height\r\n        const t = 0.5; // Wall Thickness\r\n\r\n        // Remove old walls if any\r\n        this.walls.forEach(w => this.group.remove(w.mesh));\r\n        this.walls = [];\r\n\r\n        // 1. Back Wall\r\n        const back = new Wall(this.width, h, t);\r\n        back.setPosition(0, h / 2, -this.depth / 2);\r\n        this.addWall(back);\r\n\r\n        // 2. Front Wall\r\n        const front = new Wall(this.width, h, t);\r\n        front.setPosition(0, h / 2, this.depth / 2);\r\n        this.addWall(front);\r\n\r\n        // 3. Left Wall\r\n        const left = new Wall(t, h, this.depth);\r\n        left.setPosition(-this.width / 2, h / 2, 0);\r\n        this.addWall(left);\r\n\r\n        // 4. Right Wall\r\n        const right = new Wall(t, h, this.depth);\r\n        right.setPosition(this.width / 2, h / 2, 0);\r\n        this.addWall(right);\r\n    }\r\n\r\n    addWall(wall) {\r\n        this.walls.push(wall);\r\n        this.group.add(wall.mesh);\r\n    }\r\n\r\n    addFurniture(furniture) {\r\n        this.furnitureList.push(furniture);\r\n        this.group.add(furniture.root);\r\n    }\r\n\r\n    /**\r\n     * Factory method to create instance from JSON data\r\n     */\r\n    static fromJSON(data) {\r\n        const room = new Room(data.name, data.width, data.depth);\r\n        if (data.furniture) {\r\n            data.furniture.forEach(itemData => {\r\n                const furniture = Furniture.fromJSON(itemData);\r\n                room.addFurniture(furniture);\r\n            });\r\n        }\r\n        return room;\r\n    }\r\n\r\n    /**\r\n     * Deep Clone\r\n     */\r\n    clone() {\r\n        const clonedRoom = new Room(this.name, this.width, this.depth);\r\n\r\n        // Clone Furniture\r\n        this.furnitureList.forEach(item => {\r\n            const clonedItem = item.clone();\r\n            clonedRoom.addFurniture(clonedItem);\r\n        });\r\n\r\n        // Copy room transform\r\n        clonedRoom.group.position.copy(this.group.position);\r\n        clonedRoom.group.userData.entityId = this.generateId();\r\n\r\n        // Note: Walls are generated by constructor, so they are fresh and correct size. \r\n        // No need to manually clone them unless we support custom wall modifications.\r\n\r\n        return clonedRoom;\r\n    }\r\n}\r\n\r\nclass Layout3D {\r\n    constructor(id, description) {\r\n        this.id = id;\r\n        this.description = description;\r\n        this.rooms = [];\r\n        this.group = new THREE.Group();\r\n        this.group.userData = { entityId: id, type: 'Layout3D', isMaster: true };\r\n    }\r\n\r\n    addRoom(room) {\r\n        this.rooms.push(room);\r\n        this.group.add(room.group);\r\n    }\r\n\r\n    /**\r\n     * Async Load all assets\r\n     */\r\n    async loadAssets() {\r\n        const loader = new GLTFLoader();\r\n        const promises = [];\r\n\r\n        this.rooms.forEach(room => {\r\n            room.furnitureList.forEach(furniture => {\r\n                promises.push(furniture.loadModel(loader));\r\n            });\r\n        });\r\n\r\n        await Promise.all(promises);\r\n    }\r\n\r\n    static fromJSON(data) {\r\n        const layout = new Layout3D(data.id, data.name);\r\n        if (data.rooms) {\r\n            data.rooms.forEach(roomData => {\r\n                const room = Room.fromJSON(roomData);\r\n                layout.addRoom(room);\r\n            });\r\n        }\r\n        return layout;\r\n    }\r\n\r\n    clone() {\r\n        const clonedLayout = new Layout3D(this.id, this.description);\r\n\r\n        // Deep clone rooms\r\n        this.rooms.forEach(room => {\r\n            const clonedRoom = room.clone();\r\n            clonedLayout.addRoom(clonedRoom);\r\n        });\r\n\r\n        clonedLayout.group.userData.isMaster = false;\r\n\r\n        return clonedLayout;\r\n    }\r\n}\r\n\r\n/**\r\n * Prototype Registry\r\n */\r\nclass LayoutRegistry {\r\n    constructor() {\r\n        this.masters = new Map();\r\n    }\r\n\r\n    registerMaster(id, layout) {\r\n        console.log(`[Registry] Registering Master Layout: ${id}`);\r\n        this.masters.set(id, layout);\r\n    }\r\n\r\n    getSessionClone(id) {\r\n        const master = this.masters.get(id);\r\n        if (!master) {\r\n            throw new Error(`Layout ${id} not found in registry.`);\r\n        }\r\n        // console.log(`[Registry] Creating Session Clone for: ${id}`);\r\n        return master.clone();\r\n    }\r\n}\r\n\r\nexport {\r\n    Furniture,\r\n    Wall,\r\n    Room,\r\n    Layout3D,\r\n    LayoutRegistry\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}